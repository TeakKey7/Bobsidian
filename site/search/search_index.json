{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Directory Overview Cyber Blue Team Linux Checklist Linux Investigation Log Analysis Event IDs Windows Windows Hardening Windows Tools System Admin Active Directory Bash Linux CLI Windows CLI Windows GUI","title":"Home"},{"location":"#directory-overview","text":"Cyber Blue Team Linux Checklist Linux Investigation Log Analysis Event IDs Windows Windows Hardening Windows Tools System Admin Active Directory Bash Linux CLI Windows CLI Windows GUI","title":"Directory Overview"},{"location":"Cyber/Blue-Team/Linux/Checklist/","text":"chkrootkit rkhunter -c -sk sudo bash -c 'for user in $(cut -f1 -d: /etc/passwd); do entries=$(crontab -u $user -l 2>/dev/null | grep -v \"^#\"); if [ -n \"$entries\" ]; then echo \"$user: Crontab entry found!\"; echo \"$entries\"; echo; fi; done' ps -eFH Tools dumpzilla","title":"Checklist"},{"location":"Cyber/Blue-Team/Linux/Checklist/#ps-efh","text":"","title":"ps -eFH"},{"location":"Cyber/Blue-Team/Linux/Checklist/#tools","text":"dumpzilla","title":"Tools"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/","text":"Securing binaries export PATH=/mnt/usb/bin:/mnt/usb/sbin export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64 debsums -e --config config files -c --changed only output changed files Forensics ls -l mtime (modify timestamp) ls -lc ctime (change timestamp) metadeta/filename/permissions ls -la atime (access timestamp) Volatility Extractors LiME (Linux Memory Extractor) creates .dmp fmem avml memdump coredump process specific Steps python3 vol.py -f [file] banner gets the uname of Linux Create symbol table (vol3) using dwarf2json if versions match or use https://isf-server.techanarchy.net/ Move isf (.json) to volatility3/symbols Symbols Linux.pslist process list linux.sockstat network list linux.bash bash history linux.pstree process tree linux.lsof linux.vmayarascan find malware signatures Find find / -type f -executable 2> /dev/null Good files to check ~/.bash_history run history in terminal cat /var/log/auth.log | grep useradd /etc/systemd/system /var/log/syslog User config Config files /etc/passwd cat /etc/passwd | cut -d: -f1,3 | grep ':0$' /etc/group Groups /etc/group groups [USER] getent group adm getent group 27 Process snooping lsof -i Network connections -P display port numbers -n show ips instead of resolving hostnames -p PID Network osqueryi SELECT pid, fd, socket, local_address, remote_address FROM process_open_sockets WHERE pid = 267490; netstat -a, --all : Show both listening and non-listening sockets. -l, --listening : Show only listening sockets. -t, --tcp : Display TCP connections. -u, --udp : Display UDP connections. -4, --inet : Show only IPv4 connections. -6, --inet6 : Show only IPv6 connections. -n, --numeric : Display numerical addresses instead of resolving host, port, or user names, which speeds up output generation. -p, --program : Show the PID and name of the program to which each socket belongs (PID/Program Name). Root privileges are typically required to view this information. Processes ps aux a all users u user oriented (user and start time) x Include processes not attached to a terminal ps -eFH -e select all processes -F extra full mode -H process hierarchy (forest) pstree [PID] -p list PID -s list child processes parents top -d [seconds] refresh rate -c display full command paths -u [user] only show a specific user's processes who logged in users Log Analysis grep grep [SEARCH TERM] file.txt wc -c --bytes -m --chars -l --lines (newlines) -w --words Snooping Shells echo $SHELL cat /etc/shells chsh -s /usr/bin/zsh history System stuff Systemd /etc/systemd/system Cron /var/spool/cron/crontabs/[username] /etc/crontab main cron file /etc/cron*/ Contains system cron jobs Other persistance ~/.config/autostart/ Disks df -hT View usage and types of disks dd if=<source> of=<destination> bs=<block_size> status=progress sudo dd if=/dev/sdb1 of=/path/to/disk_image.img bs=4M status=progress mount -o ro [device] [destination] Read only mount","title":"Linux investigation"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#securing-binaries","text":"export PATH=/mnt/usb/bin:/mnt/usb/sbin export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64 debsums -e --config config files -c --changed only output changed files","title":"Securing binaries"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#forensics","text":"ls -l mtime (modify timestamp) ls -lc ctime (change timestamp) metadeta/filename/permissions ls -la atime (access timestamp)","title":"Forensics"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#volatility","text":"","title":"Volatility"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#extractors","text":"LiME (Linux Memory Extractor) creates .dmp fmem avml memdump coredump process specific","title":"Extractors"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#steps","text":"python3 vol.py -f [file] banner gets the uname of Linux Create symbol table (vol3) using dwarf2json if versions match or use https://isf-server.techanarchy.net/ Move isf (.json) to volatility3/symbols","title":"Steps"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#symbols","text":"Linux.pslist process list linux.sockstat network list linux.bash bash history linux.pstree process tree linux.lsof linux.vmayarascan find malware signatures","title":"Symbols"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#find","text":"find / -type f -executable 2> /dev/null","title":"Find"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#good-files-to-check","text":"~/.bash_history run history in terminal cat /var/log/auth.log | grep useradd /etc/systemd/system /var/log/syslog","title":"Good files to check"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#user-config","text":"","title":"User config"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#config-files","text":"/etc/passwd cat /etc/passwd | cut -d: -f1,3 | grep ':0$' /etc/group","title":"Config files"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#groups","text":"/etc/group groups [USER] getent group adm getent group 27","title":"Groups"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#process-snooping","text":"lsof -i Network connections -P display port numbers -n show ips instead of resolving hostnames -p PID","title":"Process snooping"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#network","text":"osqueryi SELECT pid, fd, socket, local_address, remote_address FROM process_open_sockets WHERE pid = 267490; netstat -a, --all : Show both listening and non-listening sockets. -l, --listening : Show only listening sockets. -t, --tcp : Display TCP connections. -u, --udp : Display UDP connections. -4, --inet : Show only IPv4 connections. -6, --inet6 : Show only IPv6 connections. -n, --numeric : Display numerical addresses instead of resolving host, port, or user names, which speeds up output generation. -p, --program : Show the PID and name of the program to which each socket belongs (PID/Program Name). Root privileges are typically required to view this information.","title":"Network"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#processes","text":"ps aux a all users u user oriented (user and start time) x Include processes not attached to a terminal ps -eFH -e select all processes -F extra full mode -H process hierarchy (forest) pstree [PID] -p list PID -s list child processes parents top -d [seconds] refresh rate -c display full command paths -u [user] only show a specific user's processes who logged in users","title":"Processes"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#log-analysis","text":"","title":"Log Analysis"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#grep","text":"grep [SEARCH TERM] file.txt","title":"grep"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#wc","text":"-c --bytes -m --chars -l --lines (newlines) -w --words","title":"wc"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#snooping","text":"","title":"Snooping"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#shells","text":"echo $SHELL cat /etc/shells chsh -s /usr/bin/zsh history","title":"Shells"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#system-stuff","text":"","title":"System stuff"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#systemd","text":"/etc/systemd/system","title":"Systemd"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#cron","text":"/var/spool/cron/crontabs/[username] /etc/crontab main cron file /etc/cron*/ Contains system cron jobs","title":"Cron"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#other-persistance","text":"~/.config/autostart/","title":"Other persistance"},{"location":"Cyber/Blue-Team/Linux/Linux-investigation/#disks","text":"df -hT View usage and types of disks dd if=<source> of=<destination> bs=<block_size> status=progress sudo dd if=/dev/sdb1 of=/path/to/disk_image.img bs=4M status=progress mount -o ro [device] [destination] Read only mount","title":"Disks"},{"location":"Cyber/Blue-Team/Log%20analysis/Event%20IDs/","text":"Security Event ID Description 4624 A user account successfully logged in 4625 A user account failed to login 4634 A user account successfully logged off 4720 A user account was created 4724 An attempt was made to reset an account's password 4722 A user account was enabled 4725 A user account was disabled 4726 A user account was deleted","title":"Security"},{"location":"Cyber/Blue-Team/Log%20analysis/Event%20IDs/#security","text":"Event ID Description 4624 A user account successfully logged in 4625 A user account failed to login 4634 A user account successfully logged off 4720 A user account was created 4724 An attempt was made to reset an account's password 4722 A user account was enabled 4725 A user account was disabled 4726 A user account was deleted","title":"Security"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/","text":"The basics Eternal Blue Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol ARP Posoining arp -a Check ARP status arp -d Clear ARP cache Check for DNS spoofing C:\\Windows\\System32\\Drivers\\etc\\hosts AppLocker Local Computer Policy Antivirus Virus & Threat Protection > Exclusions Purpose what does the vm do? network shares running processes Keep in mind /TEMP/* IS BAD","title":"The basics"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#the-basics","text":"","title":"The basics"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#eternal-blue","text":"Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol","title":"Eternal Blue"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#arp-posoining","text":"arp -a Check ARP status arp -d Clear ARP cache","title":"ARP Posoining"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#check-for-dns-spoofing","text":"C:\\Windows\\System32\\Drivers\\etc\\hosts","title":"Check for DNS spoofing"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#applocker","text":"Local Computer Policy","title":"AppLocker"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#antivirus","text":"Virus & Threat Protection > Exclusions","title":"Antivirus"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#purpose","text":"what does the vm do? network shares running processes","title":"Purpose"},{"location":"Cyber/Blue-Team/Windows/Windows%20Hardening/#keep-in-mind","text":"/TEMP/* IS BAD","title":"Keep in mind"},{"location":"Cyber/Blue-Team/Windows/Windows%20Tools/","text":"Sysinternals TCPView Tcpvcon in cli Process Explorer OSQuery SQL syntax Wazuh Endpoint detection and response (EDR)","title":"Sysinternals"},{"location":"Cyber/Blue-Team/Windows/Windows%20Tools/#sysinternals","text":"","title":"Sysinternals"},{"location":"Cyber/Blue-Team/Windows/Windows%20Tools/#tcpview","text":"Tcpvcon in cli","title":"TCPView"},{"location":"Cyber/Blue-Team/Windows/Windows%20Tools/#process-explorer","text":"","title":"Process Explorer"},{"location":"Cyber/Blue-Team/Windows/Windows%20Tools/#osquery","text":"SQL syntax","title":"OSQuery"},{"location":"Cyber/Blue-Team/Windows/Windows%20Tools/#wazuh","text":"Endpoint detection and response (EDR)","title":"Wazuh"},{"location":"Cyber/System-Admin/Active-Directory/","text":"Group Policy C:\\Windows\\SYSVOL\\sysvol\\ is a network share on the Domain Controller containing all group policy","title":"Group Policy"},{"location":"Cyber/System-Admin/Active-Directory/#group-policy","text":"C:\\Windows\\SYSVOL\\sysvol\\ is a network share on the Domain Controller containing all group policy","title":"Group Policy"},{"location":"Cyber/System-Admin/Bash/","text":"!/bin/bash - shebang (haSH - BANG) Basic logic for i in {1..10}; do echo $i done if [ \"$name\" = \"Johnny\" ]; then echo \"Hello World\" else rm -fr / #Remove French language pack fi","title":"!/bin/bash - shebang (haSH - BANG)"},{"location":"Cyber/System-Admin/Bash/#binbash-shebang-hash-bang","text":"","title":"!/bin/bash - shebang (haSH - BANG)"},{"location":"Cyber/System-Admin/Bash/#basic-logic","text":"for i in {1..10}; do echo $i done if [ \"$name\" = \"Johnny\" ]; then echo \"Hello World\" else rm -fr / #Remove French language pack fi","title":"Basic logic"},{"location":"Cyber/System-Admin/Linux-CLI/","text":"Operators & Runs commands in the background && Runs multiple commands in one line > Redirects the output of a command somewhere else >> Appends the output of a command somewhere else 2>/dev/null Ignores any file permission errors Dumb stuff stty sane fix dumb tty errors after SSH (no backspace or arrows) Also try export TERM=linux","title":"Operators"},{"location":"Cyber/System-Admin/Linux-CLI/#operators","text":"","title":"Operators"},{"location":"Cyber/System-Admin/Linux-CLI/#_1","text":"Runs commands in the background","title":"&amp;"},{"location":"Cyber/System-Admin/Linux-CLI/#_2","text":"Runs multiple commands in one line","title":"&amp;&amp;"},{"location":"Cyber/System-Admin/Linux-CLI/#_3","text":"Redirects the output of a command somewhere else","title":"&gt;"},{"location":"Cyber/System-Admin/Linux-CLI/#_4","text":"Appends the output of a command somewhere else","title":"&gt;&gt;"},{"location":"Cyber/System-Admin/Linux-CLI/#2devnull","text":"Ignores any file permission errors","title":"2&gt;/dev/null"},{"location":"Cyber/System-Admin/Linux-CLI/#dumb-stuff","text":"stty sane fix dumb tty errors after SSH (no backspace or arrows) Also try export TERM=linux","title":"Dumb stuff"},{"location":"Cyber/System-Admin/Windows-CLI/","text":"Command Line Powershell Powershell is an object-oriented language. Powershell returns an object for each command which can be piped | into a function. Recommended Tools: VS-Code Helpful Commands Get-Command Lists all available commands Using Get-Command -CommandType \"Function\" limits results to functions such as math operations Get-Help Can be used to explain any command Get-Help Get-Date Adding -examples shows common uses Get-FileHash Defaults to SHA256. Use -Algorithm . Windows commands Get-ComputerInfo Get-LocalUser Returns a list of all local accounts Get-NetIPConfiguration DNS, Gateway, Adapter descriptions Get-NetIPAddress Useful to determine IPv6 schemes Invoke-Command Uses PSRemoting (WinRM) to execute commands on a remote machine Live commands Get-Process Similar to Task Manager Get-Service Get-NetTCPConnection File manipulation New-Item New-Item -Path \"C:\\folder\" -ItemType \"Directory\" New-Item -Path \"C:\\file.txt\" -ItemType \"File\" Remove-Item -Path Copy-Item -Path Get-Content -Path Similar to cmd's type and Unix's cat Aliases Common commands such as cd or dir are actually aliases to their Verb-Noun counterparts; Set-Location and Get-ChildItem respectively. Avoid using aliases in scripts when alternatives are available. VS-Code will warn when alternatives are available. Piping Sort-Object Get-ChildItem | Sort-Object Length Sorts the directory by file size Where-Object Get-ChildItem | Where-Object -Property \"Name\" -like \"flag*\" Recursively searches an array (or folder) for anything matching. Returns multiple objects Operations == -eq , != -ne , > -gt , >= -ge , < -lt , <= -le Select-String Uses -pattern to search for Regex Further reading Modules Just like any other programming language, Powershell contains libraries called Modules. They can be searched using Find-Module and installed using Install-Module . Cmd Commands Systeminfo Hostname OS Version IP address + NICS Control Opens control panel / settings windows control /name Microsoft.WindowsUpdate Tracert Netstat Active connections netstat -abon -a displays all established connections and listening ports -b shows the program associated with each listening port and established connection -o reveals the process ID (PID) associated with the connection -n uses a numerical form for addresses and port numbers Check for listeners that seem suspicious (high port numbers, ESTABLISHED but not listening, incorrect port numbers) File navigation dir The Windows equivalent of ls /a displays hidden and system files /s displays files in the current directory and subdirectories Use tree instead mkidr and rmdir File manipulation type Windows equivalent of cat more / less Pipe long commands into more command | more copy / move del / erase Tasklist Use filters tasklist /? tasklist /FI \"imagename eq sshd.exe\" taskkill /PID 1234 Most system tasks should be ABOVE explorer.exe wmic use alias process for blue team check for bad launch arguments (Ports, ips, etc) Sysinternals -accepteula handle.exe equivalent to lsof autorunsc hunt for persistence scans registries for autorun commands sigcheck - -o use virustotal","title":"Command Line"},{"location":"Cyber/System-Admin/Windows-CLI/#command-line","text":"","title":"Command Line"},{"location":"Cyber/System-Admin/Windows-CLI/#powershell","text":"Powershell is an object-oriented language. Powershell returns an object for each command which can be piped | into a function. Recommended Tools: VS-Code","title":"Powershell"},{"location":"Cyber/System-Admin/Windows-CLI/#helpful-commands","text":"Get-Command Lists all available commands Using Get-Command -CommandType \"Function\" limits results to functions such as math operations Get-Help Can be used to explain any command Get-Help Get-Date Adding -examples shows common uses Get-FileHash Defaults to SHA256. Use -Algorithm .","title":"Helpful Commands"},{"location":"Cyber/System-Admin/Windows-CLI/#windows-commands","text":"Get-ComputerInfo Get-LocalUser Returns a list of all local accounts Get-NetIPConfiguration DNS, Gateway, Adapter descriptions Get-NetIPAddress Useful to determine IPv6 schemes Invoke-Command Uses PSRemoting (WinRM) to execute commands on a remote machine","title":"Windows commands"},{"location":"Cyber/System-Admin/Windows-CLI/#live-commands","text":"Get-Process Similar to Task Manager Get-Service Get-NetTCPConnection","title":"Live commands"},{"location":"Cyber/System-Admin/Windows-CLI/#file-manipulation","text":"New-Item New-Item -Path \"C:\\folder\" -ItemType \"Directory\" New-Item -Path \"C:\\file.txt\" -ItemType \"File\" Remove-Item -Path Copy-Item -Path Get-Content -Path Similar to cmd's type and Unix's cat","title":"File manipulation"},{"location":"Cyber/System-Admin/Windows-CLI/#aliases","text":"Common commands such as cd or dir are actually aliases to their Verb-Noun counterparts; Set-Location and Get-ChildItem respectively. Avoid using aliases in scripts when alternatives are available. VS-Code will warn when alternatives are available.","title":"Aliases"},{"location":"Cyber/System-Admin/Windows-CLI/#piping","text":"Sort-Object Get-ChildItem | Sort-Object Length Sorts the directory by file size Where-Object Get-ChildItem | Where-Object -Property \"Name\" -like \"flag*\" Recursively searches an array (or folder) for anything matching. Returns multiple objects","title":"Piping"},{"location":"Cyber/System-Admin/Windows-CLI/#operations","text":"== -eq , != -ne , > -gt , >= -ge , < -lt , <= -le Select-String Uses -pattern to search for Regex","title":"Operations"},{"location":"Cyber/System-Admin/Windows-CLI/#further-reading","text":"Modules Just like any other programming language, Powershell contains libraries called Modules. They can be searched using Find-Module and installed using Install-Module .","title":"Further reading"},{"location":"Cyber/System-Admin/Windows-CLI/#cmd-commands","text":"","title":"Cmd Commands"},{"location":"Cyber/System-Admin/Windows-CLI/#systeminfo","text":"Hostname OS Version IP address + NICS","title":"Systeminfo"},{"location":"Cyber/System-Admin/Windows-CLI/#control","text":"Opens control panel / settings windows control /name Microsoft.WindowsUpdate","title":"Control"},{"location":"Cyber/System-Admin/Windows-CLI/#tracert","text":"","title":"Tracert"},{"location":"Cyber/System-Admin/Windows-CLI/#netstat","text":"Active connections netstat -abon -a displays all established connections and listening ports -b shows the program associated with each listening port and established connection -o reveals the process ID (PID) associated with the connection -n uses a numerical form for addresses and port numbers Check for listeners that seem suspicious (high port numbers, ESTABLISHED but not listening, incorrect port numbers)","title":"Netstat"},{"location":"Cyber/System-Admin/Windows-CLI/#file-navigation","text":"dir The Windows equivalent of ls /a displays hidden and system files /s displays files in the current directory and subdirectories Use tree instead mkidr and rmdir","title":"File navigation"},{"location":"Cyber/System-Admin/Windows-CLI/#file-manipulation_1","text":"type Windows equivalent of cat more / less Pipe long commands into more command | more copy / move del / erase","title":"File manipulation"},{"location":"Cyber/System-Admin/Windows-CLI/#tasklist","text":"Use filters tasklist /? tasklist /FI \"imagename eq sshd.exe\" taskkill /PID 1234 Most system tasks should be ABOVE explorer.exe","title":"Tasklist"},{"location":"Cyber/System-Admin/Windows-CLI/#wmic","text":"use alias process for blue team check for bad launch arguments (Ports, ips, etc)","title":"wmic"},{"location":"Cyber/System-Admin/Windows-CLI/#sysinternals","text":"-accepteula","title":"Sysinternals"},{"location":"Cyber/System-Admin/Windows-CLI/#handleexe","text":"equivalent to lsof","title":"handle.exe"},{"location":"Cyber/System-Admin/Windows-CLI/#autorunsc","text":"hunt for persistence scans registries for autorun commands","title":"autorunsc"},{"location":"Cyber/System-Admin/Windows-CLI/#sigcheck","text":"","title":"sigcheck"},{"location":"Cyber/System-Admin/Windows-CLI/#-o-use-virustotal","text":"","title":"- -o use virustotal"},{"location":"Cyber/System-Admin/Windows-GUI/","text":"Control Panel MSConfig Safe boot List of commands Compmgmt Shared drives Local Computer Policy AppLocker Vocab Volume Shadow Copy Service (VSS) Configs C:\\Windows\\System32\\Drivers\\etc\\hosts","title":"Control Panel"},{"location":"Cyber/System-Admin/Windows-GUI/#control-panel","text":"","title":"Control Panel"},{"location":"Cyber/System-Admin/Windows-GUI/#msconfig","text":"Safe boot List of commands","title":"MSConfig"},{"location":"Cyber/System-Admin/Windows-GUI/#compmgmt","text":"Shared drives","title":"Compmgmt"},{"location":"Cyber/System-Admin/Windows-GUI/#local-computer-policy","text":"AppLocker","title":"Local Computer Policy"},{"location":"Cyber/System-Admin/Windows-GUI/#vocab","text":"Volume Shadow Copy Service (VSS)","title":"Vocab"},{"location":"Cyber/System-Admin/Windows-GUI/#configs","text":"C:\\Windows\\System32\\Drivers\\etc\\hosts","title":"Configs"}]}